generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id @default(uuid())
  username     String   @unique
  email        String   @unique
  password     String
  rating       Int      @default(1200)
  gamesAsWhite Game[]   @relation("WhitePlayer")
  gamesAsBlack Game[]   @relation("BlackPlayer")
  createdAt    DateTime @default(now())
}

model Game {
  id             String   @id @default(uuid())

  playerWhiteId  String
  playerWhite    User     @relation("WhitePlayer", fields: [playerWhiteId], references: [id])

  playerBlackId  String?  // Make the foreign key optional
  playerBlack    User?    @relation("BlackPlayer", fields: [playerBlackId], references: [id])

  result         String?  // "white", "black", "draw", or null
  ratingChange   Int?     // positive/negative rating impact for the player
  moves          Json
  type           String   // "vsAI", "multiplayer", etc.
  duration       Int?     // Duration in seconds
  difficulty     String?  // Optional for multiplayer/AI

  createdAt      DateTime @default(now())
}
